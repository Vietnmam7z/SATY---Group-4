{"mode":"block","xmlText":"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"jg{|.UU;/^UXk2.veF3{\">object_level</variable><variable id=\"ssSE91PebES$^$+$S7^c\">liquid_level</variable><variable id=\"OxJ@94*[0.VgDRm~NT2i\">temperature</variable><variable id=\"{+HJT!*43?fPzk2E?m3|\">voltage</variable><variable id=\"5fv]%LtaXO)Uwt^lN2rt\">mounting_height</variable><variable id=\"mb[XeY5@*jZrZ7pcj)@*\">operating_time</variable></variables><block type=\"uno_event_start\" id=\"M*:thOJoC*b]vsK+UpB[\" x=\"-763\" y=\"-338\"><statement name=\"ONSTART\"><block type=\"uno_uart_init\" id=\"%WQCL)Sm.uBoM}CDz$,Z\" disabled=\"true\"><field name=\"RX\">D3</field><field name=\"TX\">D4</field><field name=\"BAUDRATE\">9600</field><next><block type=\"modbus_init\" id=\"]|8sE0XZy_TSDGeDp(CY\"><field name=\"RX\">D3</field><field name=\"TX\">D4</field><field name=\"BAUD\">9600</field><next><block type=\"coreiot_connect\" id=\"Yy`I[G/AQ`J|wxsW#,T?\"><field name=\"WIFI\">ACLAB</field><field name=\"PASSWORD\">ACLAB2023</field><field name=\"TOKEN\">UvLkTK1JJt3tE69bROhZ</field><field name=\"HOST\">app.coreiot.io</field><field name=\"PORT\">1883</field></block></next></block></next></block></statement></block><block type=\"uno_event_timer\" id=\"fm3ugd]F3{F5K-K06e4-\" x=\"-737\" y=\"-137\"><value name=\"INTERVAL\"><shadow type=\"math_number\" id=\"xW_579[=4r4%#vaB|[c^\"><field name=\"NUM\">1</field></shadow></value><statement name=\"ACTION\"><block type=\"uno_uart_write_bytes\" id=\"m0%vlvEbs#w%SgI55]0Y\" disabled=\"true\"><value name=\"BYTES\"><shadow type=\"text\" id=\"J#m9)6_-/ocT{IcZfe%=\"><field name=\"TEXT\">0x01,0x03,0x00,0x02,0x00,0x02,0x65,0xcb</field></shadow></value><next><block type=\"xbot_serial_write_line\" id=\"`;h$j%8D7zT)vC1*!;3+\" disabled=\"true\"><value name=\"line\"><shadow type=\"text\" id=\"pT{}-_~_)1l$_zPvc!K4\"><field name=\"TEXT\"> </field></shadow><block type=\"uno_uart_read_bytes\" id=\"#Hoz{7PH6o1?{{h-Odon\"><value name=\"BYTES\"><shadow type=\"math_number\" id=\"88|K$IJr9Mc;bmih*AKc\"><field name=\"NUM\">9</field></shadow></value></block></value><next><block type=\"procedures_callnoreturn\" id=\"^_`ZUr65l9cjK)]Qj!pZ\"><mutation name=\"check_mounting_height\"></mutation><next><block type=\"procedures_callnoreturn\" id=\"lJE0B54dt$HW/FZ7WpS=\"><mutation name=\"check_liquid_level\"></mutation><next><block type=\"procedures_callnoreturn\" id=\"YR*s#HK%vcK_IDJ??6Z/\"><mutation name=\"check_operating_time\"></mutation><next><block type=\"procedures_callnoreturn\" id=\"rEkU4EeBO=*f^fDM5PM:\"><mutation name=\"check_object_level\"></mutation><next><block type=\"procedures_callnoreturn\" id=\"ANtmH-aftx82acYW2(eC\"><mutation name=\"check_temperature\"></mutation><next><block type=\"procedures_callnoreturn\" id=\"?Y!8Z{bWvfLF=v;)WgM^\"><mutation name=\"check_voltage\"></mutation><next><block type=\"xbot_serial_write_line\" id=\"y;q{TGJKpO(eLXNNyWOe\"><value name=\"line\"><shadow type=\"text\" id=\"|5Xir$_|5y[c:noDNhxx\"><field name=\"TEXT\"> </field></shadow><block type=\"text_join\" id=\"5}:sK9F(1cs5j?j?w8^V\"><mutation items=\"1\"></mutation><value name=\"ADD0\"><block type=\"variables_get\" id=\"+i;#]MPbKxB#$n2?82`k\"><field name=\"VAR\" id=\"mb[XeY5@*jZrZ7pcj)@*\">operating_time</field></block></value></block></value><next><block type=\"xbot_serial_write_line\" id=\"#.7VvxVjYQ/.hJ|Av|@W\"><value name=\"line\"><shadow type=\"text\" id=\"|5Xir$_|5y[c:noDNhxx\"><field name=\"TEXT\"> </field></shadow><block type=\"text_join\" id=\"!JUnFU^/e2;TE$I=3|4x\"><mutation items=\"2\"></mutation><value name=\"ADD0\"><block type=\"variables_get\" id=\"7A^dZP~i*SfKa=g7AoON\"><field name=\"VAR\" id=\"OxJ@94*[0.VgDRm~NT2i\">temperature</field></block></value><value name=\"ADD1\"><block type=\"text\" id=\"!l_RB(lDu9MLRwX-$Kij\"><field name=\"TEXT\"> C</field></block></value></block></value><next><block type=\"xbot_serial_write_line\" id=\"rL0aJKaVJ!jzyKU4+~,E\"><value name=\"line\"><shadow type=\"text\" id=\"|5Xir$_|5y[c:noDNhxx\"><field name=\"TEXT\"> </field></shadow><block type=\"text_join\" id=\"RW{k{/ABxRHNO4VJ0e}E\"><mutation items=\"2\"></mutation><value name=\"ADD0\"><block type=\"variables_get\" id=\"5IL7%K0susw*UM$Z*7P9\"><field name=\"VAR\" id=\"{+HJT!*43?fPzk2E?m3|\">voltage</field></block></value><value name=\"ADD1\"><block type=\"text\" id=\"h}YRV[NsR17GFK%@Sh=x\"><field name=\"TEXT\"> V</field></block></value></block></value><next><block type=\"coreiot_send_telemetry_multiple\" id=\"^li(B2T}{WEo)OnkmEv3\"><mutation items=\"6\"></mutation><field name=\"KEY0\">temperature</field><field name=\"KEY1\">level</field><field name=\"KEY2\">voltage</field><field name=\"KEY3\">liquid_level</field><field name=\"KEY4\">mounting_height</field><field name=\"KEY5\">operating_time</field><value name=\"VALUE0\"><shadow type=\"text\" id=\"QPx,T_*-e]=jvz_Px;VL\"><field name=\"TEXT\">value</field></shadow><block type=\"variables_get\" id=\";}T!;D4stX,c`p:HG^CG\"><field name=\"VAR\" id=\"OxJ@94*[0.VgDRm~NT2i\">temperature</field></block></value><value name=\"VALUE1\"><shadow type=\"text\" id=\"Yy=^yZQ)nW]fr1jLFK_a\"><field name=\"TEXT\">value</field></shadow><block type=\"variables_get\" id=\"BB=B*2#C{NqOH~b8tazA\"><field name=\"VAR\" id=\"jg{|.UU;/^UXk2.veF3{\">object_level</field></block></value><value name=\"VALUE2\"><block type=\"variables_get\" id=\"$b6jYtbNj|)k8.Q:GMF2\"><field name=\"VAR\" id=\"{+HJT!*43?fPzk2E?m3|\">voltage</field></block></value><value name=\"VALUE3\"><block type=\"variables_get\" id=\";{1aDb~Ykg7tqn{fCOIG\"><field name=\"VAR\" id=\"ssSE91PebES$^$+$S7^c\">liquid_level</field></block></value><value name=\"VALUE4\"><block type=\"variables_get\" id=\";nNqh8w+}[0ou.i(}su:\"><field name=\"VAR\" id=\"5fv]%LtaXO)Uwt^lN2rt\">mounting_height</field></block></value><value name=\"VALUE5\"><block type=\"variables_get\" id=\"_lz1*uKuLAABsDqzLn1O\"><field name=\"VAR\" id=\"mb[XeY5@*jZrZ7pcj)@*\">operating_time</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"procedures_defnoreturn\" id=\",yS?vOD;N]{(]tYCumMp\" x=\"287\" y=\"-188\"><field name=\"NAME\">check_object_level</field><comment pinned=\"false\" h=\"80\" w=\"160\">Mô tả hàm này...</comment><statement name=\"STACK\"><block type=\"variables_set\" id=\"?Rlm0Lah(,-O]O!-z*y1\"><field name=\"VAR\" id=\"jg{|.UU;/^UXk2.veF3{\">object_level</field><value name=\"VALUE\"><block type=\"math_arithmetic\" id=\"D{B^jNPgM%{WP#Ql89!s\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\" id=\"TUBT4!|55JJd25aCu)k2\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\" id=\"{~p]hTB*8d(;,3:T{qh`\"><field name=\"VAR\" id=\"5fv]%LtaXO)Uwt^lN2rt\">mounting_height</field></block></value><value name=\"B\"><shadow type=\"math_number\" id=\"R{]dufjBFChESAZlgl+w\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\" id=\":M94kN#Z}Tpchkzy$j~}\"><field name=\"VAR\" id=\"ssSE91PebES$^$+$S7^c\">liquid_level</field></block></value></block></value></block></statement></block><block type=\"procedures_defnoreturn\" id=\"u|v2cjxI2c#m`5E~W0,y\" x=\"287\" y=\"-88\"><field name=\"NAME\">check_liquid_level</field><comment pinned=\"false\" h=\"80\" w=\"160\">Mô tả hàm này...</comment><statement name=\"STACK\"><block type=\"variables_set\" id=\"cDA6G?2A%DMmiU]_{3ZE\"><field name=\"VAR\" id=\"ssSE91PebES$^$+$S7^c\">liquid_level</field><value name=\"VALUE\"><block type=\"modbus_read_float\" id=\"JT1]U+.C*4RfMJ@VA[9D\"><field name=\"BYTE_ORDER\">big</field><value name=\"SLAVE_ID\"><shadow type=\"math_number\" id=\"=A_}YJ*m69b;-fayXDCc\"><field name=\"NUM\">1</field></shadow></value><value name=\"FUNC_CODE\"><shadow type=\"math_number\" id=\"!lveKC`aoIWL_x1L{Hj]\"><field name=\"NUM\">3</field></shadow></value><value name=\"REGISTER_ADDR\"><shadow type=\"math_number\" id=\"Bk*ZyrC`!8jA80h}JNu9\"><field name=\"NUM\">0</field></shadow></value></block></value></block></statement></block><block type=\"procedures_defnoreturn\" id=\"o400,7JMMq}td:}+~!sJ\" x=\"287\" y=\"13\"><field name=\"NAME\">check_temperature</field><comment pinned=\"false\" h=\"80\" w=\"160\">Mô tả hàm này...</comment><statement name=\"STACK\"><block type=\"variables_set\" id=\"+bQ2/7;2e*7K`LzwG%CB\"><field name=\"VAR\" id=\"OxJ@94*[0.VgDRm~NT2i\">temperature</field><value name=\"VALUE\"><block type=\"modbus_read_float\" id=\"@*bG*ZR|vk8Ga3qrfG/6\"><field name=\"BYTE_ORDER\">big</field><value name=\"SLAVE_ID\"><shadow type=\"math_number\" id=\"8PQ^)jcyv+@39/%$LY^7\"><field name=\"NUM\">1</field></shadow></value><value name=\"FUNC_CODE\"><shadow type=\"math_number\" id=\"I?c(:9cH2F=!-A.7mm?R\"><field name=\"NUM\">3</field></shadow></value><value name=\"REGISTER_ADDR\"><shadow type=\"math_number\" id=\"w$1z5D|H9SDnqwz66so]\"><field name=\"NUM\">2</field></shadow></value></block></value></block></statement></block><block type=\"procedures_defnoreturn\" id=\"g=_+m6+;ILicF65;gTpx\" x=\"288\" y=\"112\"><field name=\"NAME\">check_voltage</field><comment pinned=\"false\" h=\"80\" w=\"160\">Mô tả hàm này...</comment><statement name=\"STACK\"><block type=\"variables_set\" id=\"px}azrx5WLY:x95ca3Q=\"><field name=\"VAR\" id=\"{+HJT!*43?fPzk2E?m3|\">voltage</field><value name=\"VALUE\"><block type=\"modbus_read_float\" id=\"k;%,BC+x^n2T#pX1Ip~T\"><field name=\"BYTE_ORDER\">big</field><value name=\"SLAVE_ID\"><shadow type=\"math_number\" id=\",g/rv0vo_c|O/YtR=S(^\"><field name=\"NUM\">1</field></shadow></value><value name=\"FUNC_CODE\"><shadow type=\"math_number\" id=\"^:~JlOq6G2.U_KP_7Iw4\"><field name=\"NUM\">3</field></shadow></value><value name=\"REGISTER_ADDR\"><shadow type=\"math_number\" id=\"lmF[w?]qZ+;YHnbO#60t\"><field name=\"NUM\">4</field></shadow></value></block></value></block></statement></block><block type=\"procedures_defnoreturn\" id=\"5Y@8A}-EZ}:f@d`TzZ@2\" x=\"287\" y=\"212\"><field name=\"NAME\">check_mounting_height</field><comment pinned=\"false\" h=\"80\" w=\"160\">Mô tả hàm này...</comment><statement name=\"STACK\"><block type=\"variables_set\" id=\"#/Yb/z:k2cCc]YM=M%dv\"><field name=\"VAR\" id=\"5fv]%LtaXO)Uwt^lN2rt\">mounting_height</field><value name=\"VALUE\"><block type=\"modbus_read_float\" id=\"9eraJw.e=KL+q^+#qX#f\"><field name=\"BYTE_ORDER\">big</field><value name=\"SLAVE_ID\"><shadow type=\"math_number\" id=\"v=1SOr5@jqn)|~f];^6l\"><field name=\"NUM\">1</field></shadow></value><value name=\"FUNC_CODE\"><shadow type=\"math_number\" id=\"+.@_el:0%5apG_Adf~%I\"><field name=\"NUM\">3</field></shadow></value><value name=\"REGISTER_ADDR\"><shadow type=\"math_number\" id=\"H,eoLyAG)ZH@xR}gQnx!\"><field name=\"NUM\">10</field></shadow></value></block></value></block></statement></block><block type=\"procedures_defnoreturn\" id=\"OAchySA-@=qCvF,-Lajm\" x=\"288\" y=\"313\"><field name=\"NAME\">check_operating_time</field><comment pinned=\"false\" h=\"80\" w=\"160\">Mô tả hàm này...</comment><statement name=\"STACK\"><block type=\"variables_set\" id=\"d/flx8.2c4s^%~^u3uZ(\"><field name=\"VAR\" id=\"mb[XeY5@*jZrZ7pcj)@*\">operating_time</field><value name=\"VALUE\"><block type=\"modbus_read_float\" id=\"6J4at(q2Of$c{9%S)^#^\"><field name=\"BYTE_ORDER\">big</field><value name=\"SLAVE_ID\"><shadow type=\"math_number\" id=\"zk.@mBXC)s]FGh%IqEZC\"><field name=\"NUM\">1</field></shadow></value><value name=\"FUNC_CODE\"><shadow type=\"math_number\" id=\"tWzT`.,nMdm2nC}87Q+t\"><field name=\"NUM\">3</field></shadow></value><value name=\"REGISTER_ADDR\"><shadow type=\"math_number\" id=\"6/w6[?y.5Ah@^6#XH=1l\"><field name=\"NUM\">6</field></shadow></value></block></value></block></statement></block></xml>","python":"from modbus_master import ModbusRTU\nfrom ci_device_mqtt import *\n\nmodbus = ModbusRTU(rx=D3_PIN, tx=D4_PIN, baudrate=9600)\n\n# Mô tả hàm này...\nasync def check_object_level():\n  global object_level, liquid_level, temperature, voltage, mounting_height, operating_time\n  object_level = mounting_height - liquid_level\n\n# Mô tả hàm này...\nasync def check_liquid_level():\n  global object_level, liquid_level, temperature, voltage, mounting_height, operating_time\n  liquid_level = modbus.read_float(1, 3, 0, byte_order=\"big\")\n\n# Mô tả hàm này...\nasync def check_temperature():\n  global object_level, liquid_level, temperature, voltage, mounting_height, operating_time\n  temperature = modbus.read_float(1, 3, 2, byte_order=\"big\")\n\n# Mô tả hàm này...\nasync def check_voltage():\n  global object_level, liquid_level, temperature, voltage, mounting_height, operating_time\n  voltage = modbus.read_float(1, 3, 4, byte_order=\"big\")\n\n# Mô tả hàm này...\nasync def check_mounting_height():\n  global object_level, liquid_level, temperature, voltage, mounting_height, operating_time\n  mounting_height = modbus.read_float(1, 3, 10, byte_order=\"big\")\n\n# Mô tả hàm này...\nasync def check_operating_time():\n  global object_level, liquid_level, temperature, voltage, mounting_height, operating_time\n  operating_time = modbus.read_float(1, 3, 6, byte_order=\"big\")\n\nobject_level = None\ntemperature = None\nvoltage = None\nmounting_height = None\nliquid_level = None\noperating_time = None\nci_client = CIDeviceMqttClient('ACLAB', 'ACLAB2023', 'UvLkTK1JJt3tE69bROhZ', 'app.coreiot.io', 1883)\n\nasync def task_f_m_u_g():\n  global object_level, temperature, voltage, mounting_height, liquid_level, operating_time\n  while True:\n    await asleep_ms(1000)\n    await check_mounting_height()\n    await check_liquid_level()\n    await check_operating_time()\n    await check_object_level()\n    await check_temperature()\n    await check_voltage()\n    print((str(operating_time)))\n    print((str(temperature) + ' C'))\n    print((str(voltage) + ' V'))\n    await ci_client.send_telemetry({'temperature':temperature,'level':object_level,'voltage':voltage,'liquid_level':liquid_level,'mounting_height':mounting_height,'operating_time':operating_time})\n\nasync def setup():\n  global object_level, temperature, voltage, mounting_height, liquid_level, operating_time\n  print('App started')\n  await ci_client.connect()\n\n  create_task(task_f_m_u_g())\n\nasync def main():\n  await setup()\n  while True:\n    await asleep_ms(100)\n\nrun_loop(main())\n","name":"week6 - Tram","extensions":[{"id":"yolouno-extension-modbus485-","src":"","name":"MODBUS  RS485","description":"Mục mở rộng dùng cho cảm biến Modbus485"},{"id":"yolouno-AITT-VN-yolouno_extension_core_iot","src":"https://github.com/AITT-VN/yolouno_extension_core_iot","name":"Core IoT","description":"Library extension for Yolo UNO to work with Core IoT platform"},{"id":"yolouno-AITT-VN-yolouno_extension_uart","src":"https://github.com/AITT-VN/yolouno_extension_uart","name":"UART","description":"Mục mở rộng để làm việc với kết nối UART"}],"device":"yolouno"}